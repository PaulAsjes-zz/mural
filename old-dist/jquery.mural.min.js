/*! mural - v0.0.1 - 2014-09-25
* https://github.com/PaulAsjes/mural
* Copyright (c) 2014 Paul Asjes; Licensed MIT */
var Detect=function(){function a(a){for(var b=a.charAt(0).toUpperCase()+a.substr(1),c=(a+" "+e.join(b+" ")+b).split(" "),d=0;d<c.length;d++)if(""===f.style[c[d]])return!0;return!1}var b,c,d="transition,transform,webkitTransition,webkitTransform,msTransform".split(","),e="Webkit,Moz,O,ms,Khtml".split(","),f=document.createElement("detect"),g=[];for(b in d)c=d[b],g[c]=a(c);return g}();Detect.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);var Item=function(a,b){"use-strict";function c(a){j.css("z-index",10),n&&j.addClass(n),g=!0,a.preventDefault()}function d(){g&&j.trigger(Item.DRAG_END),g=!1,j.css("z-index",1),n&&j.removeClass(n)}function e(a){if(g){var b=a.pageX,c=a.pageY;a.touches&&(b=a.touches[0].pageX,c=a.touches[0].pageY),f(b,c)}}function f(a,b){var c=j.parent().offset(),d=a-k,e=b-l;switch(m){case"velocity":case"jquery":j.offset({left:d,top:e});break;default:case"css":if(!Detect.transform||!Detect.webkitTransform)return m="jquery",f(a,b);d-=c.left,e-=c.top;var g="translate("+d+"px, "+e+"px)";j.css("-webkit-transform",g),j.css("transform",g)}}var g=!1,h=window.jQuery,i=a,j=h(i),k=j.width()/2,l=j.height()/2,m=b.animationType,n=b.activeCSS,o=b.draggable;o&&(i.addEventListener("touchstart",c),i.addEventListener("touchend",d),i.addEventListener("touchmove",e),i.addEventListener("mousedown",c),window.document.addEventListener("mouseup",d),window.document.addEventListener("mousemove",e)),this.getElement=function(){return i},this.getJQElement=function(){return j}};Item.DRAG_END="dragend",Item.DRAG_START="dragstart",function(a){"use strict";function b(c){switch(c){case"jquery":return"jquery";case"css":return Detect.transform&&Detect.webkitTransform&&Detect.msTransform?"jquery":"css";default:case"velocity":return void 0!==a.Velocity?"velocity":b("css")}}function c(b){for(var c=a(b.currentTarget),h=!1,i=k.map(function(a){return a.getElement()}),l=0;l<k.length;l++)if(b.currentTarget!==k[l].getElement()&&overlaps(c[0],k[l].getElement(),!1,j.containerOffset)){var m={},n=c.offset();m.x=c.width()/2+n.left,m.y=c.height()/2+n.top;var o=d(m,k[l].getJQElement()),p=i.indexOf(c[0]),q=i.indexOf(k[l].getElement()),r=0;q>p?"left"===o&&(r=-1):"right"===o&&(r=1),k.splice(q+r,0,k.splice(p,1).shift()),i.splice(q+r,0,i.splice(p,1).shift()),h=!0;break}if(!h){var s=i.indexOf(c[0]);e(c,k[0].getJQElement())?k.splice(0,0,k.splice(s,1).shift()):f(c,k[k.length-1].getJQElement())&&k.splice(k.length,0,k.splice(s,1).shift())}g(k)}function d(a,b){var c=a.x-j.containerOffset.left,d=b.width()/2,e=b.position(),f=e.left+d;return f>c?"left":"right"}function e(a,b){return a.position().top<b.position().top}function f(a,b){return a.position().top>b.position().top}function g(a){var b=j.container.width(),c=parseInt(a[0].getJQElement().css("width"),10);j.containerOffset=j.container.offset();var d=c+j.wgap+j.wgap/a.length,e=Math.floor(b/d);e>j.maxColumns?e=j.maxColumns:1>e&&(e=1),e>a.length&&(e=a.length);for(var f=0;f<a.length;f++){var g=Math.floor(f/e),i=f%e,k=a[f].getJQElement(),l=k.width(),m=k.height(),n=l+j.wgap,o=m+j.hgap;k[0].newT=j.containerOffset.top+g*o;var p=0;if(j.centered){var q=e*l+j.wgap*(e-1);p=(b-q)/2}k[0].newL=Math.round(j.containerOffset.left+p+i*n),k[0].newT<0&&(k[0].newT=0),k[0].newL<0&&(k[0].newL=0)}h(a)}function h(a){for(var b=0;b<a.length;b++){var c=a[b].getJQElement(),d=c.position(),e=c.parent().offset();if(d.top!==c[0].newT||d.left!==c[0].newL)switch(j.animationType){case"jquery":c.stop(!0,!1),c.animate({top:c[0].newT,left:c[0].newL},j.speed);break;case"velocity":c.velocity({top:c[0].newT,left:c[0].newL},j.speed);break;default:case"css":c[0].newL-=e.left,c[0].newT-=e.top;var f="translate("+c[0].newL+"px, "+c[0].newT+"px)";c.css("-webkit-transition","-webkit-transform "+j.speed/1e3+"s"),c.css("-webkit-transform",f),c.css("transform",f),function(b){setTimeout(function(){a[b].getJQElement().css("-webkit-transition","")},j.speed)}(b)}}j.onReshuffle&&setTimeout(function(){j.onReshuffle.call(this,a.map(function(a){return a.getElement()}))},j.speed)}var i=function(){},j={},k=[];a.fn.mural=function(d){j=a.extend({},a.fn.mural.defaults,d),j.container=this,j.animationType=b(j.animationType);var e=null;a.isPlainObject(j.order)&&j.order.data&&(e=j.order.data.map(function(b){return a("["+j.order.attribute+"|="+b).get(0)}));for(var f=e||a(j.itemSelector),h=0;h<f.length;h++){var i=new Item(f[h],j);k.push(i),i.getJQElement().bind(Item.DRAG_END,c).css("position","absolute")}j.container=this,j.containerOffset=this.offset();var l;return a(window).resize(function(){clearTimeout(l),l=setTimeout(function(){g(k)},150)}),g(k),this},a.fn.mural.defaults={itemSelector:".mural-item",speed:500,wgap:50,hgap:50,maxColumns:1/0,minColumns:1,shrinkOnResize:!0,onReshuffle:i,animationType:"auto",centered:!0,activeCSS:"",order:null,draggable:!0},a.expr[":"].mural=function(b){return-1!==a(b).text().indexOf("awesome")}}(jQuery);var overlaps=function(a){"use-strict";function b(a){var b,c,d;return b=e(a).position(),c=e(a).width(),d=e(a).height(),[[b.left,b.left+c],[b.top,b.top+d]]}function c(a,b){var c,d,e=b.left||0,f=b.top||0;return c=a.x-e,d=a.y-f,[[c,c+1],[d,d+1]]}function d(a,b){var c,d;return c=a[0]<b[0]?a:b,d=a[0]<b[0]?b:a,c[1]>d[0]||c[0]===d[0]}var e=a.jQuery;return function(a,e,f,g){var h,i;return f?(h=c(a,g),i=b(e),d(h[0],i[0])&&d(h[1],i[1])):(h=b(a),i=b(e),d(h[0],i[0])&&d(h[1],i[1]))}}(window);